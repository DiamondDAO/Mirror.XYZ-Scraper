"{\"content\":{\"body\":\"zk-Rollup （ZKR） 被 V 神称为以太坊的终极 L2 扩容解决方案。很多专家学者，包括 Vitalik 本人认为通用型的 ZKR 平台还需要数年的时间才会看到。因此，现阶段的焦点是期望 Optimistic Rollup （比如 Optimism、 Arbitrum 和 Boba Network）可以先担起以太坊扩容的大旗，之后随着 ZKR 技术的成熟和就绪，大家再转向 ZKR。但令人激动的是，ZKR 技术已经开始通过 zkSync 和 StarkWare 等平台走向市场。\\n\\n本文将聚焦于 L2 扩容的发展以及 zk-Rollup 的崛起。\\n\\n## L2: 重要性和历史发展\\n\\n“不可能三角”是以太坊这样的 L1 区块链面临的永恒的难题，不同的链也总是在去中心化、安全性和可扩展性三者间寻找平衡。很多时候，一条区块链为了顾及其中两个方面，而不得不牺牲第三个方面。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbfecd058-adb2-4f98-906a-e8b77d1d126d_748x639.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fbfecd058-adb2-4f98-906a-e8b77d1d126d_748x639.png)\\n\\n以太坊更侧重于去中心化和安全性，因此不得不面临可拓展性方面的限制。以太坊链上手续费之高，以至于大部分人不能承担在 L1 层的转账费用(见下图的 Messari 研究报告)。\\n\\n人们需要一个方案，既可以解决可拓展性问题，同时也不会牺牲去中心化或安全性。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5e31b6bf-2deb-4170-a283-2708c999ee1a_1210x601.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F5e31b6bf-2deb-4170-a283-2708c999ee1a_1210x601.png)\\n\\n有两种方法可以对区块链进行扩容，第一种是对 L1 层区块链本身进行扩容，方法有增加区块大小，或分片（将交易分配给不同组的验证者，而不是让验证者处理所有交易）。然而，这样做肯定会带来去中心化或安全性上的牺牲。第二种方法是将 L1 层网络上的交易转移至 L2 层。使用 L2 层扩容方案在不牺牲去中心化或安全性的前提下，解决区块链的可扩展性问题。\\n\\nL2 解决方案在二层对交易进行汇集，然后发送至 L1 层网络进行结算。这样，每一批交易付一笔 gas 费用，而不是每笔交易都付 gas 费用。因此，所有交易对 gas 费用进行平摊，有效降低了每笔交易的费用。这样，L1 就成为了 L2 上所有执行交易的结算层。\\n\\n总结一下，L2 解决方案在不牺牲去中心化或安全性的前提下，通过非常低廉的手续费来帮助区块链进行扩容。\\n\\n**模块化区块链 vs. 单片式区块链**\\n\\nL2 扩容是“模块化区块链”的一部分。在传统的“单片式区块链”中，所有的功能都发生在 L1 。\\n\\n从本质上来说，区块链主要处理三件事：\\n\\n* 执行 → 运算: 计算机的 CPU ；计算层\\n* 安全 → 共识: PoW 或 PoS；\\n* 数据可用性 → 将区块数据储存在链上；\\n\\n在‘单片式区块链’中，所有这三种功能都是由 L1 进行。因此，L1 也受到“不可能三角”的限制，从而影响到效率。 “模块化区块链”将每项功能进行划分，不同的功能采用不同的解决方案，比如： L2 解决方案上对执行层的扩容，在 L1 层进行结算前在 L2 层进行交易归集和执行。此外，还会有其它的解决方案来改进安全性和数据可用性（从 PoW 转向 PoS 以及数据分片）。\\n\\n过去一年中，因为新用户对于低 gas 费的追求，许多其它的 L1 区块链网络日渐崛起。这也让一些人认为这些替代性的 L1 网络才是社区真正需要的扩容方案。虽然从某种程度上来说，不无道理——像 Solana 这样的区块链也在引入新型的架构。不少 L1 区块链兼容 EVM，并称有更高的 TPS，但仍然要指出在使用率达到一定高水平的阶段，这些区块链也会遇到和以太坊一样的可拓展性问题。近期，Avalanche 因网络活跃度的提升而带来的 gas 数十倍飙升就是个例子。\\n\\n作者当然并不是反对 Avalanche，只是为了指出 L2 扩容方案对于高需求量的区块链来说都是非常必须的，而不仅仅是以太坊。扩容是区块链发展和演进中非常重要的一部分，随着交易量的增长，其它 L1 网络也会面临以太坊的同样问题。L2 解决方案则可以在保持去中心化和安全性的前提下让区块链进行扩容。\\n\\n那么问题来了，L2 到底是什么？它的工作原理又是如何？\\n\\n## 以太坊 L2 的演化\\n\\n**以太坊 L2 扩容史是从“状态通道”（state channels）到 Plasma 到 Rollup 的演变史。**\\n\\n### 状态通道\\n\\n状态通道是一种由多签智能合约支撑的链下扩容方案，ETH 等资产锁定在合约中，用户之间创建双向支付通道，用户可以在链下进行点对点的转账，然后在链上进行结算。\\n\\n换句话说，状态通道就像是在“记账”，用户彼此之间可以在链下进行数百次交易，然后通过向以太坊 L1 发送最后一笔交易来停止记账。这样一来，原本是许多笔的交易，通过状态通道得以简化。\\n\\n* 举例说明：用户 A 和用户 B 通过多签将资金存入一个“通道”中，通过这个通道，A 和 B 可以进行点对点的交易，而不需要每笔交易都发送到 L1 层网络结算。不需要的情况下，通道则可以关闭。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ff6034a1a-d2e6-4f8b-ab8c-ba1f43755d0b_682x501.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ff6034a1a-d2e6-4f8b-ab8c-ba1f43755d0b_682x501.png)\\n\\n这样并非每笔交易都在 L1 进行处理，于是节省了手续费，但是并不支持更加广泛的应用，因为用户必须通过多签来与特定的其它方之间进行转账。\\n\\n**Plasma**\\n\\nPlasma 创造了一系列的“子链”来分散转账负荷。每一条子链都有一个运营者（中心化角色、多签或 PoS 系统）可以在 L2 区块中处理成千上万笔交易，并捆绑为一笔单一交易提交给 L1。如果遇到有争议的交易，会采用“欺诈证明”的方式来验证。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F2e9874a5-7fbb-4d2f-998a-3a1078c91cdf_471x673.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F2e9874a5-7fbb-4d2f-998a-3a1078c91cdf_471x673.png)\\n\\nPlasma 的方向是正确的，但问题是 L2 每一笔交易的数据并不能为 L1 所用，也就是说数据可用性(DA)是在链下的。因此，这种方法不能作为通用型方案。\\n\\n“通用型”意味着什么？为何如此重要？\\n\\n通用型方案支持 EVM 运行环境。通用型 L2 方案可以让现有的以太坊应用简单方便地迁移到 L2。这样的重要性在于已有的应用是经过测试的，相比新代码的合约风险更小；而且这些应用已经有了足够的用户基础，这些用户也能够受益于 L2 手续费的降低。\\n\\n如何建立通用型的 L2？这里就到了我们要将的 Rollup 部分。\\n\\n**Rollup**\\n\\n记住，“通道”和 Plasma 将所有交易高效地在链下（off-chain）进行处理，并不会将每笔交易的数据同步到 L1 ，这也限制了它们称为通用型解决方案的能力。\\n\\nRollup 搭建在以太坊主网之上，它将多笔交易汇总起来，打包成一笔提交给以太坊主链，而不是让主链单独处理每一笔交易。Rollup 将运算和状态存储放到链下，但是每笔交易中的部分数据在链上，也就是对主网可用，因此每笔交易依然是回到 L1 进行结算。rollup 的高效之处在于将每笔交易的大小进行压缩，然后再在 L1 进行结算。这将大大增加可拓展性，但仍受 L1 数据可用性的限制。\\n\\n数据可用性是指每笔交易的数据储存在链上，数据可用性的重要意义主要体现在两个方面：\\n\\n* 这些数据是存在共识的 (利用 L1 的去中心化和安全性) ，任何人都可以处理 Rollup 中的交易来保证没有欺诈；\\n* 有了数据可用性，Rollup 才是通用型的方案，可以做到 EVM 兼容，并在修改很少代码的前提下轻松地对应用迁移；\\n\\n这也是为何以太坊将 Rollup 作为主要的 L2 扩容方案—— Rollup 可以让用户在 L2 上体验 L1 层的各种应用，而且花费手续费更低，同时还能维持 L1 的去中心化和安全性。比如 Uniswap 就可以非常简单地迁移到 Optimism L2 上。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ff21a53fb-4bc5-4511-b953-57bdbf408a48_583x402.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ff21a53fb-4bc5-4511-b953-57bdbf408a48_583x402.png)\\n\\n**Rollups 的分类**\\n\\n目前，主要有两种类型的 Rollups: Optimistic Rollups （使用欺诈证明）和 ZK Rollups （使用零知识证明）\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ffe5fa395-3a35-4c18-b205-90c9a57960cb_691x214.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Ffe5fa395-3a35-4c18-b205-90c9a57960cb_691x214.png)\\n\\n在 Optimistic Rollup 中，L2 交易被验证人进行排序和分组，送到 L1 层进行结算。网络上的任何人都可以成为验证人，这些验证人提交以太坊等资产作为押金。任何网络的参与者都可以针对一笔交易提出异议，如果真的存在欺诈，那么发送这笔虚假交易的验证人的押金就会被没收。在一批交易得到处理后，有一个7天的异议提交窗口期。Optimistic Rollup 又被称为“欺诈证明”，在被证明是欺诈前，所有的交易都乐观地被假设是“有效的”。\\n\\nOptimistic Rollup 二层扩容方案是由 Optimism 和 Arbitrum 提出并首先推向市场，但相对于其它新型的 L1 层区块链（Solana 或 Avalanche）并没有得到广泛采用和关注。L2 上的手续费依旧不算低廉，应用开发缓慢，用户迁移的动力不足。根据 DeFiLama 的数据，截至2021年11月30日，Arbitrum 和 Optimism 的 TVL 仅仅占以太坊 L1 总 TVL 的一小部分。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F82b41962-7188-42c5-9159-af1877e179e0_406x349.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2F82b41962-7188-42c5-9159-af1877e179e0_406x349.png)\\n\\n**Zero Knowledge-Rollups (ZKR)**\\n\\nZero Knowledge-Rollups (ZKR) 依赖零知识证明这项密码学技术。ZKR 将交易执行和共识、数据可用性分离开来，L2 上的多个交易打包之后会变成一个零知识证明（zkSNARK 或 zkSTARK）并可被 L1 快速验证，所以零知识证明验证的成本会分摊到每个交易上，这样能省 Gas Fee 和提高 TPS。\\n\\n因为 Rollup 上的每笔交易的 input 数据都储存在 L1 ，其它节点可以验证这些交易的有效性，决定是否接受或拒绝这笔交易。因此，如果 zk Rollup 上的一个用户想要进行一次双花，L1 上的节点就会拒绝。\\n\\nZKR 的另外一个重要的特性是验证比运算成本低很多，这样的简洁性为扩容提供了条件。但零知识证明技术上复杂度非常高，需要大量的运算，交易的时延也会变长。\\n\\n简单来说，相较于 Optimistic Rollup，ZKR 技术上更加复杂，每笔交易手续费更低，但是运算成本更高昂。\\n\\n![https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5006702-1875-4ee9-bd6d-cd34d89f7baf_427x211.png](https://cdn.substack.com/image/fetch/w_1100,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fb5006702-1875-4ee9-bd6d-cd34d89f7baf_427x211.png)\\n\\nStarkWare 和 zkSync 是 ZKR 领域的两个主要选手，他们在通用型 ZKR 平台上的进展均比市场期望的更快。zkSync 采用的是零知识证明中的 SNARK 技术，StarkWare 采用的是更具可拓展性的 STARK 技术。后面我们会有专门的文章介绍这两个项目。\\n\\n采用 STARK 技术的目前有 :\\n\\n[@StarkWareLtd](https://twitter.com/StarkWareLtd)\\n\\n[@0xPolygonMiden](https://twitter.com/0xPolygonMiden)\\n\\n采用 SNARK 技术的目前有 :\\n\\n[@zksync](https://twitter.com/zksync)\\n\\n[@loopringorg](https://twitter.com/loopringorg)\\n\\n[@0xPolygonHermez](https://twitter.com/0xPolygonHermez)\\n\\n[@aztecnetwork](https://twitter.com/aztecnetwork)\\n\\n[@0xPolygonZero](https://twitter.com/0xPolygonZero)\\n\\n【References】\\n\\n1. <https://cryptoexplainere60.substack.com/p/zk-world-pt-1>\\n2. <https://thedefiant.io/zero-knowledge-ethereum-layer-1/>\\n\\nTwitter: ZK 爱好者 @ZKP101\",\"timestamp\":1640962511,\"title\":\"Layer2 的发展以及 zk-Rollup 的崛起 | ZK 科普系列（二）\"},\"digest\":\"wA-nH_zclxbdercqmYph7qcZNj4Rly3eAWJVTNqTQK4\",\"authorship\":{\"contributor\":\"0xb7a833DEB62fb0d19fC58D9Dee7dBe9161410290\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"rBXoBHJzE7DSGhSSG7BInUo_XuiztEiNyO1d8VNRfG8\\\",\\\"y\\\":\\\"_RYVh1Di2BXvyFcA7J1V-SGbuO0iz0-xN1xkZ0YkaaU\\\"}\",\"signature\":\"HD4URYkqFusM1ZsO-Kx2z8nzdKcDVgw1NR_L4RHOFQ1__vxSCZIx9ozeRLruZIeJe6Y5QBbY8dPflN-2dAJ_gQ\",\"signingKeySignature\":\"0x7c94c6f882d1ce34ce8f23a8bba0be7be26a90a7d62ff7db4fc6bc36017e9fe868764c891d8f8d3e28d5f3d18e0ffb3eed8ca93a001a50de3f882bb7b73a88591c\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"rBXoBHJzE7DSGhSSG7BInUo_XuiztEiNyO1d8VNRfG8\\\",\\\"y\\\":\\\"_RYVh1Di2BXvyFcA7J1V-SGbuO0iz0-xN1xkZ0YkaaU\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"wA-nH_zclxbdercqmYph7qcZNj4Rly3eAWJVTNqTQK4\"}"