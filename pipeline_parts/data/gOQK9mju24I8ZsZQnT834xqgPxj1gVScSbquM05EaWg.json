"{\"content\":{\"body\":\"## I. Development Process of Perpetual Derivatives\\n\\nThe first stage in the development of perpetual derivatives is inverse perpetual contracts, namely the Bitcoin inverse perpetual contracts developed by Bitmex in 2016. In the traditional delivery futures, there are mechanisms such as settlement date, delivery and contract position transfer. Through the combination of the three mechanisms of pledge, fund rate and price tracking, perpetual derivatives enables perpetual contracts to shine brightly. However, it is not until 2020 that a large number of exchanges follow perpetual derivatives.\\n\\nAccording to BitMex’s research, the yield rate on long inverse contracts is unbalanced: A market dominated by inverse contracts is more unfavorable for both holders of long or short position. Later, due to the introduction of stable coin, vanilla futures  contracts began to replace inverse contracts because the yield rate was more linear. That is, inverse contracts feature the convexity, which is similar to the nature of gamma in options. Thus, Bitcoin is actually not normally distributed and has a drift over a period of time, the yield ratio between long and short position is not balanced. Vanilla futures contracts make up for the nonlinear part of inverse contracts.\\n\\nFigure: Non-linear yield of inverse contracts\\n\\nSource: <https://blog.bitmex.com/zh_cn-convexity-rektum-damn-near-killed-em/>\\n\\nThe second stage of perpetual derivatives is on-chain perpetual contracts, and perpetual derivatives were launched with AMM going to the public in the DeFi summer chain in 2020. The second stage can be regarded as the process from concept validation to implementation of perpetual derivatives, with a daily trading volume of several hundred million US dollars. Due to performance limitations, it has not reached the stage of large-scale use.\\n\\nSource: The Block\\n\\nIn the third stage, with the launch of Layer2, the limitation of the bottom performance of perpetual contracts has been broken. The orderbook has become the optional direction of the project again, and the integrated liquidity of Uniswap V3 has its own feature of orderbook, allowing professional market makers and traders to enter. Derivatives are not just speculation; and complex combination of on-chain derivative strategies begins to be adopted.\\n\\nWe believe that the fourth stage of perpetual derivatives is that **perpetual options** will become an instrument approved by new traders in 2022-23. With Paradigm’s discussion of **everlasting option** and some projects landing on the on-chain perpetual options, there will be more agreements to participate in this non-linear game. In the fourth stage, the market will begin to understand the greeks trading and portfolio opportunities brought by nonlinear derivatives. Perpetual options solve the dilemma that the liquidity of delivery options is divided on a two-dimensional plane. Long-tail assets will get more attention. Besides, the relatively large volatility may enable them to become a favorite type of instruments by traders.\\n\\nPerpetual derivatives will eventually coexist with other delivery derivatives, generating more strategies for arbitrage of non-perpetual contracts against intertemporal derivatives. When the market returns to a multi-product state and liquidity rises sharply, it will enter a stage where the derivative market is much larger than the spot market talked by optimists (that is, using the TAM method of estimation). Another important feature of the fourth stage is that fixed income derivatives have become popular, thus really entering a very institutionalized era. Interest rate, a product that has not been traded before, is replenished.\\n\\nWe hold that perpetual derivatives boasts the following functions:\\n\\n* A tool that facilitates the direction of the game. The existence of perpetual derivatives in the market proves the applicability of perpetual contracts\\n* A management portfolio tool, that can be combined with spot goods, delivery futures and delivery options. Professional traders can build more types of portfolios. Perpetual contracts, expiring contracts, perpetual options and expiring options can form a unique portfolio\\n* A way for providing fixed income. Because perpetual contracts have a special way of maintaining price stability, the form of purely acquiring fund rate is bound to prevail among professional traders, similar to the carry trade in foreign exchange. In addition to the portfolios that professional traders build themselves, some contracts start to template such portfolios.\\n* Provide a way to decentralize volatility trading. Use perpetual options to downplay the characteristics of delta and theta.\\n* Liquidity site for long-tail tokens\\n\\n## II. Pricing of Perpetual Derivatives\\n\\nDifferential form of general options:\\n\\nS is underlying asset, σ means implied volatility, t is time, z is Gaussian process, and f is option price.\\n\\nFutures can be regarded as the part containing linear term only:\\n\\nFutures and options can be viewed as leverage over future objects. If there are no boundary conditions, options also include a quadratic term (i.e., volatility) in price change, and a value over time. Options can be regarded as having linear term, quadratic term and time item. Futures can be regarded as an option with only delta term, and option currency futures have more gamma and theta terms. The logic of futures is relatively simple, and both buyers and sellers have rights and obligations. Due to the existence of the exercise price, options have the payoff function, which is determined by the existence of the option premium. The buyer of options has only the right and no obligation, and the assignment of this obligation is expressed by the option premium. In selling the premium, the seller is obliged to make delivery on the due date.\\n\\nThe fund rate is the most delicate part of perpetual futures contracts, and all derivatives are expanding around their own rates. In other words, the buyer or seller of the fund pays the fund rate to the other party to maintain the balance between the futures price and the underlying price (index). However, as the possibility of liquidation of perpetual contracts with high leverage increases, perpetual options provide another solution: 1. perpetual options will not be liquidated, and the buyer of options has only right and no obligation. 2. On the premise of no liquidation, the leverage ratio will be enlarged.\\n\\nThe main problem to be solved by options is pricing. The introduction of quadratic term and time make the price show convexity. The difference between option pricing (put option) and actual transaction price is the profit source of option trading.\\n\\nThere have been many discussions about perpetual options in academic circles, such as the analytical solution of non-exercise of American call option and put option. However, the largest threshold for the user of options is: 1 understanding the relationship between options and underlying objects; 2 what additional benefits the options offer compared to the futures, so that the user can make an equivalent choice between the two. Due to historical reasons and product complexity, most users started with futures.\\n\\nParadigm provides a way of expression of pricing perpetual options with rate:\\n\\nDeri protocol launched perpetual options on August 11, using the Paradigm model of pricing options and launching another expression of the perpetual model:\\n\\nAnd C (t) and P (t) are denoted by the general BS model\\n\\nThe on-chain perpetual option protocol Shield protocol takes a step further and provides the analytic solution of the perpetual options:\\n\\nThe analytical solution of Shield Protocol is based on the empirical results of dynamic hedge validation of three-year historical data and over-the-counter option pricing theoretical study.\\n\\nThe pricing formula of perpetual options plays a fundamental role in the whole perpetual products, and the seller of options can calculate the risk exposure, that is, the traditional option seller strategy can be realized. The option pricing model proposed by Black, Sholes and Merton in 1973 is still the most important method to the pricing of options up to now, and the analytical solution is always the pearl of pricing. Of course, most options pricing formulas still depend on numerical solution because the analytical solution of the option model is too difficult to calculate.\\n\\n## III. Major Perpetual Derivatives Projects\\n\\n**Industry map**\\n\\n**dYdX**\\n\\nFounded in 2017, dYdX provides cryptocurrency derivative products including perpetual contracts, spot and leveraged trading, and lending. The perpetual contracts of dYdX take USDC as collateral, and can use crossmargin, that is, multiple contracts use the same collateral. The funding rate of the perpetual contracts is settled on an hourly basis. The funding rate of dYdX also considers the interest spread of direct lending and the formula is:\\n\\nFunding Rate = (Premium Component/8) + Interest Rate Component\\n\\nThe perpetual contracts of dYdX are based on the zk-rollup designed by Starkwarre. The zk rollup completes customer transactions off-chain and transfers the transaction results to the chain. The rollup is responsible for packaging transactions, and zk is responsible for providing zero-knowledge proof that the deposit into layer2 is valid. The interaction process is as follows:\\n\\n* Ethereum to Layer2: dYdX monitors related Ethereum transactions, i.e. deposits, forced withdrawals and forced transactions. Once such transactions are received on Ethereum, operations such as adding funds will be performed on Layer2.\\n* Layer2 to Ethereum: After a batch of transactions is executed off-chain, a proof of their validity is generated and verified by the STARK verifier on the chain. The state transition takes effect after the STARK verifier approves the state transition, such as saving or withdrawing from the Layer2 to change the user’s Ethereum balance.\\n\\ndYdX uses orderbook system, which can provide order with price limit, so it will be more suitable for derivatives. Perpetual derivatives agreement Injective has compared the two mechanisms of orderbook and AMM.\\n\\nAMMOrderbookAdvantages\\n\\n• Allowing liquidity to exist in illiquid markets\\n\\n• A trader can always get a quote in the absence of a counterparty\\n\\n• Orderbook trading is ideal for liquid markets\\n\\n• Orderbook exchanges are still the best choice for surface market prices and placing large orders\\n\\n• The exchange of orders reduces the risk of decline\\n\\n• Orderbook exchanges are widely accepted by institutional investors and retail dealers\\n\\nDisadvantages\\n\\n• Due to the small liquidity pool, there is a risk of significant decline in large-amount orders\\n\\n• Capital is inefficient because most transactions are executed within a narrow range of price levels, unless the market is extremely volatile\\n\\n• Gratuitous loss of liquidity providers\\n\\n• Compared with CLOB transaction execution model, the risk of early operation is higher\\n\\n• No transaction can be made if the buyer’s bid is below the seller’s lowest bid, which will be a poor design for an illiquid market\\n\\n• Orders are often at risk from front running. Front running is the risk that a miner will be able to extract a particular block from the information provided when the order is placed. This means that miners can make risk-free profits.\\n\\nThe advantage of the orderbook system lies in that it can provide many complex order types, but still relies on market makers, such as Wintermute as a market maker for dYdX. Thus, the orderbook and market makers are essentially a system. In addition to professional market makers, general liquidity providers can add USDC to the liquidity pool, and professional market makers can then apply this part of the USDC to distinguish liquidity from market making, which further facilitates participation by users who have funds but no trading capacity.\\n\\nMuch like the traditional trading market, the biggest innovation of dYdX is API which can already provide the level similar to the centralized exchange, that is, such an API completely removes the blockchain logic from it and only keeps remaining part applicable to market makers. For example, 1.25ETH is 1.25, instead of the most basic representation of wei. According to Wintermute’s feedback, crossmargin is friendly to market makers and can save a lot of capital.\\n\\nAfter the launch of Layer2 on dYdX, the transaction volume has risen sharply\\n\\nOne-day trading volume can reach USD 7 billion. However, as the market declines, the trading volume also decreases. Three largest trading pairs are BTC/ETH/SOL/COMP.\\n\\n**Layer2 engine**\\n\\ndYdX uses the StarkEX engine that is a Layer2 network-based trading engine developed by Starkware. The engine was launched in June 2020 and can support many purposes, such as spot trading, perpetual contract trading and NFT trading. Starkware can support data on-chain (ZK – Rollup) and data off-chain (Validium) modes.\\n\\nSource: Starkware\\n\\nThe user’s funds are transferred to the StarkEX contract to achieve decentralized self- hosting, and then can be traded on dYdX. Starkex’s off-chain component manages all trade orders and sends status update to the on-chain component after execution.\\n\\nChanges in transaction and status are verified by StarkEX verifier. SHARP is a tool that packages various statements into proofs. Currently, Stark engine supports several agreements, such as dYdX, DeversiFi, Immutable and Sorare.\\n\\n**Perpetual Protocol**\\n\\nPerpetual once was the first largest perpetual futures market (currently the second) according to trading volume in the whole network, the V1 version of Perpetual uses a trading pool of vAMM type, and vAMM is an extended type of AMM. In terms of volume, Perpetual, dYdX and Futureswap top three in perpetual derivatives.\\n\\n \\n\\nvAMM adopts the calculation method of AMM but does not adopt the clearing method of AMM. The value of K can be adjusted and should be matched with the OTC market. The larger the value of K is, the lower the slip point will be. vAMM can use almost infinite liquidity, so that there is almost no trade slip point according to the constant product formula k=x\\\\*y. All AMM pools with low liquidity are subject to insufficient liquidity and large trading slip point. The true clearing and settlement of vAMM is at the bottom of Perpetual, with insurance fund acting as a liquidity provider. Perpetual’s v1 uses xDai as a two-layer solution.\\n\\nInsurance fund bears the counterparty risk of vAMM (such as consistently long position and consistently short position). If the business does not develop continuously and stably, the growth of insurance fund should not be sustainable. Large negative fluctuation will offset the increase in insurance fund for a few weeks.\\n\\nIn the new V2, Perpetual takes advantage of the liquidity of Uniswap V3 to introduce counterparty and reduce liquidity risk. There are many other improvements to V2, and V2 is divided into four steps: V2.1: taking advantage of the concentrated liquidity of V3 for market-making based on Arbitrium; V2.2: launching the cash order system and staking of PERP; V2.3: multi-pledge system other than USDC; V2.4: private market without permission. In V2.2, this will become an order system with price limit like dYdX. Offchain Lab thinks Arbitrium can package 4,200 transactions per second, 300 times higher than the main Ethereum network.\\n\\nV2 of Perp selects Arbitrium. On the one hand, Uniswap V3 is related to Arbitrium, because the liquidity pool of v3 is established on v3. V3 is more progressive than Perp v1’s vAMM because the slip point of the concentrated liquidity is smaller. On the other hand, compared with Optimism, Arbitrium is fully compatible with EVM so that Uniswap can be launched online without any modification, which affects a large number of non-project choices. This is the difference between full compatibility and partial compatibility. At the end of May, Uniswap’s community group voted almost 100% in favor of v3’s launch online on Arbitrium. A number of projects have already started to support Arbitrium. 70 projects, including Aave, Band, Hop, imToken, MakerDAO, WBTC except Uniswap select Arbitrum.\\n\\n**Perpetual swap DerivaDEX**\\n\\nThe main product of DerivaDEX is the perpetual swap contract, which is an on-chain version similar to Bitmex.\\n\\nSource: DerivaDEX\\n\\nDerivaDEX uses orderbook, and DerivaDEX has also designed insurance fund similar to Perpetual Protocol to protect against certain losses in the agreement (e.g., the counterparty’s losses exceed their collateral). There is no specific solution to forced liquidation, and insurance fund is needed to solve it. This is another mechanism created by Bitmex perpetual contracts.\\n\\nIn DerivaDEX, the game of fund rate can also become a trading strategy: For example, it is possible to continuously construct a portfolio of a spot long position and a futures short position. When it is assumed that the fund rate is in his/her favor, a fixed fund rate will be earned (ideally).\\n\\nSource: DerivaDEX\\n\\n**Perpetual Options Shield Protocol**\\n\\nShield Protocol is an on-chain perpetual derivative agreement whose economic logic is non-cooperative game logic. The first version of the product is an on-chain perpetual option product, which will be followed by perpetual contract product, OTC option and structured product. It is characterized by non-pledge, transparency, no intermediary fee, no requirement of trust and easy access. The formal logic of the perpetual option product is similar to that of the perpetual futures, that is, the payoff of the option price is determined by the price change, fund fee and trading fee:\\n\\nPayoff= (No. of Contracts\\\\*Price Change) – Funding Fee – Trading Fee.\\n\\nCompared with futures, options have no concept of close-out. The maximum loss per day is the fund rate. Its liquidity is supported by private pools and public pools. The core innovation of Shield lies in the analytical solution of the pricing formula of perpetual options, like the BS model, as mentioned aforesaid.\\n\\nThe main problem with options at the market fit level is that they are not suitable for retail investors because of their complex operation, and the T-shaped quotation board is the biggest obstacle. Deribit, the largest options exchange, has less trading volume, and the options space is more suitable for professional traders. Shield’s solution to this dilemma is: first, to introduce the role of broker who helps users understand options and provide trade/investment consultation. The whole process takes place on the chain, where a broker obtains commission, which, like in traditional finance, comes from the transaction commission of the presentee. Second, to transform the traditional delivery options into perpetual options, and the user can only buy the right with a flat value, which greatly reduces the user’s threshold and risk.\\n\\nShield features a public pool and private pool system. The private pool is the main transaction pool, supplemented by the public pool. Private pool is for professional traders who can transfer risk through external hedges. The public pool has a low threshold and is suitable for retail investors and risk averters. At T=0, the private pool is equivalent to the seller of options, the trader is the seller of options, all transactions are peer to pool, and liquidity comes from the pool. The allocation of new orders is determined by random numbers, one is the hash of the block, and the other one is the time of the block. Orders are randomly matched to private pools. Providers of private pools receive trading fee based on SLD (governance token), and private pools have higher income. The liquidator obtains reward by providing liquidation services. Shield’s five roles maintain the stability of the protocol through non-cooperative games.\\n\\nThe explicit use of perpetual options is reflected in that investors do not have to bear the trouble of moving positions, and suffer no risk of forced liquidation as the holders of options. Holding options for long-term has to pay the time value, that is, there is loss of time every day, while the perpetual options do not need to pay the time value but funding fee. The implicit use of perpetual options provides derivatives that can bet on volatility. When perpetual futures and perpetual options are combined, the linear term and the time value are removed (assuming that the funding fee is controllable), the synthetic product is a pure volatility, providing large space for non-directional bets. In addition, the product portfolio is enriched, and the true composability can be embodied. Perpetual options can be combined with delivery options to form some strategies. However, the current price mechanism of perpetual options is quite complex and it is not easy to calculate the risk exposure of various greeks.\\n\\n**Perpetual template and composability – Ribbon and OPYN**\\n\\nThe story of Ribbon and OPYN shows an interesting phenomenon that complex product ideas often rely on extremely simple front-end to amplify, which shows the advantage of DeFi’s composability. Making use of the perpetual options template provided by OPYN, Ribbon Finance creates a fund pool similar to time saving, supported by the option selling strategy of put selling and covered call strategy. The combined product can provide users with a fixed income. \\n \\n\\nRibbon creates a strategic aggregate income front end for OPYN and helps users to execute put option strategies on a weekly basis, which is similar to derivatives of perpetual options. The implementation principle is that Theta Vault (the fund pool on Ribbon) casts the coverd call in OPYN with 90% of the investors’ deposited funds and sells to the market with oToken (token representing option in OPYN). The parameter setting of option is determined by Theta Vault, and the user generally chooses out-of-the-money option without consideration so as to earn premium. However, the disadvantage lies in that in the unit period, if the underlying price rises to the exercise price, the user will suffer losses.\\n\\nIt has to be mentioned here that OPYN is increasingly going to the bottom, especially some practical tools such as call option, clearing robot, option liquidity pool and perpetual option vault template that is used by Ribbon and also raises a lot of TVL for OPYN. Almost all of the recent growth in OPYN’s TVL has been driven by Ribbon.\\n\\nSource: Delphidigital\\n\\nBottom of OPYN: Perpetual Vault Templates. It uses a whole set of perpetual options templates, where anyone can construct the options they need (arbitrary exercise price, expiration date), which saves the effort of bootstrap at the bottom and comes up with any strategy, and represents this option in the form of oToken. It can accommodate a very large number of options strategies, and vault facing front end can build their own products (such as fixed income) that customers need.\\n\\n## IV. Review of Perpetual Derivatives from the Development of Options\\n\\nThe development of ancient and modern options can be traced back to the Middle East and the Tulip Bubble Age in the form of an agreed trade contract. For example, the buyer pays the seller a deposit of 3.5% -10%, and the seller is exempted from buying if the tulip price is lower than the contract price on the due date. Theories and application of modern options are both centred in the United States, where commodity options originated from crops and animal husbandry, and financial options (represented by stock options) were all decentralized and off-market options at the beginning. In 1973, a turning point in the development of the options market, the Chicago Board Options Exchange invited the Nansen Company to complete a Nansen Report. In the same year, Fisher Black, Myron Sholes and Robert Merton published two papers respectively, putting forward a similar conclusion on the option pricing model, which is later called the option pricing model of BSM.\\n\\nSEC report in 1974 quoted a lot from the Nansen Report, and four conclusions are very important: 1. exchange-traded options help to reduce the volatility of exchange-traded spot goods; 2. exchange-traded options improve liquidity of spot goods; 3. exchange-traded options will not divert liquidity; 4. exchange-traded options allow investors to face complex markets in a mature manner. In 1985, the four major regulatory agencies in the United States launched the Research on Impact of Futures and Options Trading on Economy, which, commonly known as the Quartet report, puts the development of options on the track.\\n\\nThe development of options has a very long history, which is the result of the interaction of market, theory, trader and supervision. For option corresponding to crypto, we find that the theory is basically unchanged, the market demand exists, the traders are not very mature, and the supervision takes a very negative attitude, which accords with the characteristics of the stock option market before 1973. Speculation generally prevailed in the early development of derivatives. The nature of instruments did not slowly return until the investors began to mature. For institutions and individuals, the meaning of options is obviously different. Therefore, the development of crypto options market positioning is worth thinking about.\\n\\nWhy are we bullish on perpetual derivatives at this time:\\n\\n* Performance boost: The launch of Layer2 seems to solve the performance problem. More importantly, it gives derivatives the opportunity to launch the new V. The AMM model in the base chain starts to transit to the orderbook. With the advent of Uniswap V3, the orderbook, a previously forgotten solution, has come back, with AMM.\\n* A variety of play ways: Perpetual is a good direction. Crypto has many retail users, and many people are not used to operating maturity derivatives. Perpetual derivatives have been proved by the market to combine into interesting yield products.\\n* Options fever: Options fever is on the rise. Options are well suited to the emergence of professional market makers, who have become commonplace at layer2. The pricing and timing of perpetual and everlasting options have begun to take shape, which is an important factor for professional traders to enter the market.\\n* Potential trading factors and non-trading factors: As long as the trading volume of the whole market rises, the volume of perpetual derivatives will increase very fast. And there are other factors increasing DeFi derivatives.\\n\\nRisk of perpetual derivatives:\\n\\n* The high leverage of derivatives can attract customers but also put pressure on the agreement\\n* For the designers of their pools, the provider of liquidity may face losses or be unwilling to participate actively\\n* The choice of collateral is a double-edged sword\\n* Whether the derivatives can support high trading volume has not been verified\\n* The closer to the centralized orderbook system it is, the closer to the position of competition with the centralized exchange will be. Before that, the user was stimulated by the mining/staking mechanism, followed by competition for real products.\",\"timestamp\":1638347169,\"title\":\"HashKey Capital: Industry Report on Perpetual Derivatives - Process and Trend - HashKey\"},\"digest\":\"ZVDvqYRXIWEvwgNMH1dJaxhMyZ71YXxqJs6edVEpUpk\",\"authorship\":{\"contributor\":\"0x0a88a1D4227FC91dE7D542787470a8A1f2bCE802\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"KJTSyb-zHW-2uImsNBLFzUWKTA5j7qLoKCspghhiUtM\\\",\\\"y\\\":\\\"BbkD2veBSlddHqyKOJjDo4p2kCFg27jt0JvDBZW4MLU\\\"}\",\"signature\":\"xN9GrHIwKs3rH72ibm9Sjasqkvdz64okwiiSnHsFOotXIRbG0ZAsefQl77e_RHDfWQmC3M89D2ck_CEzBAjq_A\",\"signingKeySignature\":\"0x7b8d16b2a1290070e6d52847e3879e2bfc0a1fd1c47d26c6ff6b111e2ef2ee6711a8fca0b0ac1ca07c928b6f6302b3d17782774b4a5f443a163b477055747cbf1c\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"KJTSyb-zHW-2uImsNBLFzUWKTA5j7qLoKCspghhiUtM\\\",\\\"y\\\":\\\"BbkD2veBSlddHqyKOJjDo4p2kCFg27jt0JvDBZW4MLU\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"ZVDvqYRXIWEvwgNMH1dJaxhMyZ71YXxqJs6edVEpUpk\"}"