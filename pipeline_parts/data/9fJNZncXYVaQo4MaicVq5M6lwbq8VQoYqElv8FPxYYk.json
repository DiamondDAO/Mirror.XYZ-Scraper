"{\"content\":{\"body\":\"最近市场极度萎靡，但是LUNA却是一枝独秀，在其他价值币普遍跌去30-50%的情况下，它却单周逆市上涨33%，以743亿的市值超过了AVAX来到了第8名，成为目前市场的最美逆行者。同样这使得Terra链的OHM分叉LeserveDAO更加受到关注，投资者也对其给予更多的期待。正好，今天LeserveDAO放出了它的第五篇文章《智能合约与前端/设计》，详细阐述了其智能合约架构、设计语言以及前端技术，由于其知识点比较分散，我结合自己的理解给各位稍微整理一下。\\n\\n### 一、智能合约架构\\n\\nLeserveDAO的智能合约架构与其他链的OHM分叉截然不同，由于Terra 链与 EVM 不兼容的原因，LeserveDAO需要采用与 Solidity 和 EVM 完全不同的解决方案，因此必须全部重写 Olympus 的所有代码。那么为了完全契合Terra 链，团队选择了CosmWasm 智能合约平台以及Rust语言，因此从这个角度来说，Leserve 是Terra的原生储备货币，是专门为Terra链而设计和开发的。\\n\\nLeserve的智能合约包含如下架构：\\n\\n**1、LSRV**\\n\\nLSRV 代币是标准的 CW20 代币，只有国库合约才拥有铸造代币的权利和能力。如我前一篇文章所述，LSRV是Leserve 的原生代币，是协议的关键支柱和直接表示。\\n\\n**2、国库合约**\\n\\n国库合约是 Leserve 的核心合约，负责安全地存储资金并铸造 LSRV代币。团队把国库合约设计成了完全独立的模块，这给整个协议的扩展和乐高模组化奠定了基础。\\n\\n国库合约的作用：储存 UST、LUNA和LP；通过铸造LSRV存入资金；提取资金和负债；为协议的其他合约提供资金。\\n\\n3、**价值计算器合约**\\n\\n价值计算器合约负责计算与协议交互资产的RFV和 UST 估值，各类型资产采用了不同的估值模型：\\n\\n（1）稳定币的估值为1UST；\\n\\n（2）LP 的估值根据链上的流动性池数据计算；\\n\\n（3）LUNA等其他资产的价格是根据Terra链上的ChainLink进行喂价。\\n\\n而资产的RFV计算公式如下：\\n\\nRFV = 资产价格 \\\\* (1-riskRatio)\\n\\n其中，riskRatio是给每项资产设置的风险比率，取值范围是0-1，越接近0代表风险越低，越接近1代表风险越高。使用风险比率来评估资产价值是 Leserve的核心创新之一，根据合约设定，riskRatio数值设定最后由DAO的经济委员会来确定。\\n\\n4、**债券合约**\\n\\n债券合约负责为整个 Leserve 生态系统提供债券服务。 Leserve 的债券合约设计为可以开放给第三方使用，因此开发者可以围绕债券合约开发出许多应用，比如二级债券市场。\\n\\n与OHM及其大部分的分叉不同的是，Leserve 债券允许多个债券到期期限，除了一般的5天外，还有更长的时间，当然对应了更高的折扣奖励。\\n\\n另外，Leserve针对Olympus 债券配置错误的问题进行了优化，当债券价格高于最低债券价格时，Leserve 的合约不会重置最低债券价格，以此来修复漏洞。\\n\\n5、**质押合约**\\n\\n质押合约负责奖励和激励 LSRV 持有者，用户质押 LSRV 获得sLSRV，这是一个定制的 CW20 代币合约，sLSRV 通过不断变基以保持其供应量等于 LSRV 的供应量。\\n\\n这里需要说明的是团队目前正在考虑用治理代币gLSRV来代替sLSRV，目的似乎是希望鼓励用户更多地参与到协议的治理中。\\n\\n6、**治理合约**\\n\\n治理合约负责实施 LeserveDAO 的链上治理模型，实际上是将LeserveDAO 的整个治理模型、机构和宪法内嵌入合约中，合约将持有并包含宪法的哈希值，并将实施理事会、大会、提案、司法和否决的机制。该合约由于创新较多，技术复杂，目前正处于概念阶段，将是最后一个发布的合约。\\n\\n7、**创收合约**\\n\\n创收合约负责为 gLSRV 持有者创造收入，资金分配合约管理各种策略之间的资金分配，国库资金被资金分配合约通过风险/回报矩阵分配到各种协议策略，合约获得的任何代币都将存入国库。\\n\\n8、**发射合约**\\n\\n负责协议的发射以及白名单的销售等。\\n\\n### 二、前端技术\\n\\n1、**零停机时间**\\n\\n通过用IPFS代替AWS、Azure等服务供应商，来存储协议的数据和组件，以实现协议的去中心化和零停机时间。\\n\\n2、**React 、TypeScript、Tailwindcss、NextJS**\\n\\n协议采用React框架来构建dapp，便于开发者和社区成员阅读、理解和维护；使用TypeScript代替JavaScript，避免今后将代码库整体搬迁的工作量；采用Tailwindcss来设计UI，使用NextJS进行服务器端渲染，以使协议能够敏捷快速地迭代。\\n\\n### 三、安全措施\\n\\nLeserve是目前为止我见过最重视安全的OHM分叉之一，除了第三方安全审计外，团队还采取了以下安全措施：\\n\\n（1）使用基于 CW3/CW4 智能合约的多重签名钱包；\\n\\n（2）每个核心团队成员都使用硬件钱包来管理多重签名；\\n\\n（3）每个团队成员在批准部署或者升级事务前，必须校审部署代码的哈希值；\\n\\n（4）协议设置了一个特殊的“可冻结”操作，如果协议出现任何重大安全威胁，该操作允许协议被紧急冻结。\\n\\n（5）所有链上代码和 GUI 都将开源，社区可以随时验证部署在链上的内容与 Github 上的内容是否一致。\\n\\n建立了一套单元测试和集成测试流程来测试所有合约集。\\n\\n### 四、审计\\n\\n邀请第三方审计机构对代码的每一部分进行审计，审查频率为每年至少进行一次，同时协议的重大升级前必须进行审计。\\n\\n### 五、开源开发工具\\n\\n在 Leserve 推出后，团队将开源内部开发的 TypeScript 工具，用于 Terra/CosmWasm 生态系统中的智能合约开发，该工具的功能如下：\\n\\n（1）用于合约的部署、实例化、升级和运行；\\n\\n（2）通过代理调用合约或通过多重签名钱包提交交易TX ；\\n\\n（3）与硬件钱包集成；\\n\\n（4）允许将合约分组为合约集，并以正确的顺序部署它们；\\n\\n（5）允许将合约部署到多种环境，包括测试网、主网和本地 terra；\\n\\n从 Rust Msg 模式生成合约类型。\",\"timestamp\":1640084961,\"title\":\"LeserveDAO研究笔记2\"},\"digest\":\"1FcMe829UtrlOctEBUW3ns1J8TnJJTln8Tknj8kwNPg\",\"authorship\":{\"contributor\":\"0x42c1D7C9ACc152451D92821fDa685aa3a210A5e9\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"SeekCh6wnebnyheWE1s5WRHpyVet7npjmxxWSFD8VMA\\\",\\\"y\\\":\\\"DKlg9guABDpZI2Z2MCSCeg5FnTRNJqWzBY7Dtk-WL0Y\\\"}\",\"signature\":\"Tq6ZsijrWDPGB5iCzY86z5plfF8NaX1_DH8APy9oZIeNwEwaYyexwIvVwsx5iI0Ubr2Gm7oSSIPQlLLqzJk5Hw\",\"signingKeySignature\":\"0x14bdbacd641275c34fbc25fc1f296c8cdf39651e1b40f496915856c5622462bb29a01b6d189710537869934ef96f3765d92a7842f4bb59fa92683d5582b187151c\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"SeekCh6wnebnyheWE1s5WRHpyVet7npjmxxWSFD8VMA\\\",\\\"y\\\":\\\"DKlg9guABDpZI2Z2MCSCeg5FnTRNJqWzBY7Dtk-WL0Y\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"1FcMe829UtrlOctEBUW3ns1J8TnJJTln8Tknj8kwNPg\"}"