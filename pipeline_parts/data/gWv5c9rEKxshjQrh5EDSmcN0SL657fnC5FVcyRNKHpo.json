"{\"content\":{\"body\":\"> 不同于常见的闪电贷攻击事件，AnySwap 这次的安全事件颇为新颖\\n\\nAnySwap 这次的漏洞在于意外的两笔交易使用了相同的 R 值签名。攻击者从中成功还原出了管理员账户的密钥。\\n\\n### **交易签名**\\n\\n在以太坊交易中，我们将交易中特定数据子集的哈希值用用户的私钥进行签名。其他人可以通过用户的公钥对签名进行认证。以太坊上的签名由 R，S，V 三个值组成。R 和 S 是 ECDSA 签名的输出。V 是 Recover Id，为 1 或者 ，用来辅助校验签名。\\n\\n![](https://pic3.zhimg.com/v2-1ee3bc7e0e0f4e1ca972b2bcd9afc452\\\\_b.jpg)\\n\\nhttps\\\\://learnblockchain.cn/books/geth/part3/sign-and-valid.html\\n\\n### **漏洞**\\n\\n由于 AnySwap 客户端升级，一个随机数 K 被使用了两次，这导致两笔不同的交易具有相同的 R。由于签名的信息不同，可以推导出随机数 K。再加上已经知道的公钥，我们就可以得出私钥。\\n\\n假设第一笔交易的签名为 r1，s1。第一笔交易签名的信息是z1。第二笔交易的签名是r2，s2。第一笔交易签名的信息是z2。由于在这个例子中，r1 = r2，我们用 r 来表示它们。通过这个公式我们可以推导出私钥。\\n\\n![](https://pic4.zhimg.com/v2-f7cc962a80827bf19f824000301c4fd7\\\\_b.png)\\n\\n### **相关阅读：**\\n\\n*   *[Recovering Bitcoin private keys using weak signatures from the blockchain](https://link.zhihu.com/?target=https%3A//web.archive.org/web/20160308014317/http%3A//www.nilsschneider.net/2013/01/28/recovering-bitcoin-private-keys.html)*\\n*   *[签名与校验](https://link.zhihu.com/?target=https%3A//learnblockchain.cn/books/geth/part3/sign-and-valid.html)*\\n*   *[ECDSA](https://link.zhihu.com/?target=https%3A//www.bookstack.cn/read/MasterBitcoin2CN/spilt.5.ch06.md)*\\n*   *[账户私钥被破解？拆解 Anyswap 跨链桥被⿊细节](https://link.zhihu.com/?target=https%3A//www.chainnews.com/articles/743930056070.htm)*\\n\",\"timestamp\":1633782276,\"title\":\"AnySwap 攻击事件\"},\"digest\":\"C5LcZFBX7Gz7HnEXOM4mFLxlqXUbZOan9L3aBec8GPE\",\"authorship\":{\"contributor\":\"0x7B076d7BcdE88Ec322B2D01AA1ADc1997b7724f6\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"-uhmdAZYxFgq_x4xq-zXdui7hRToWKgI3gCLaeRwzfE\\\",\\\"y\\\":\\\"e_jae50XeRHkDjBd1dCU7xTq7o4HjO4Idn3X9qLgXmA\\\"}\",\"signature\":\"zaATl1lW8PfyHeUNkvFbJvby6UXBn53fs5qTxnbvfGclGcV52daDAhN7Xv0OQN_2Y5eazIr-2G3r1pipHf12Og\",\"signingKeySignature\":\"0x0475273f3894cbe534b5ebf3dc9005f7b109c905b95b05fd0afb3d0dd6c056984938a186d9c56832d588e27230d06074bb752d52c6fbbffe3ddc0a71e38362d11c\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"-uhmdAZYxFgq_x4xq-zXdui7hRToWKgI3gCLaeRwzfE\\\",\\\"y\\\":\\\"e_jae50XeRHkDjBd1dCU7xTq7o4HjO4Idn3X9qLgXmA\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"C5LcZFBX7Gz7HnEXOM4mFLxlqXUbZOan9L3aBec8GPE\"}"