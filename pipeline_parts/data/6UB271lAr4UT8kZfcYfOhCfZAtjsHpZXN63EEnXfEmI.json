"{\"content\":{\"body\":\"## xy=k\\n\\n关于这个 V1 和 V2 版本的核心公式，相信大家已经很熟悉了，不了解的小伙伴可以看这篇 https://github.com/rebase-network/Dapp-Learning/blob/main/basic/13-decentralized-exchange/uniswap-v1-like/README.md 。\\n\\n虽然它是很经典的 AMM 公式，但存在一个很大问题，就是资金利用率不高。\\n\\n### v2 的价格区间\\n\\n我们先简单回顾一下在一个流动性池子中，如何表达资产的价格。\\n\\n假设有资产 X 和资产 Y，现在存在一个以 X 和 Y 资产组成的交易对池子。当我们要用资产 X 来标价 Y 的时候，`PriceY = x的数量 / y的数量`，这很容易想到。\\n\\n我们在直角坐标系上，用 x 轴表示资产 X 的数量，y 轴表示资产 Y 的数量，那么将上面的式子变换可以得到 `y = p * x`，为了简化，我们用 `p` 来表示 priceY。\\n\\n于是我们可以在坐标系上添加一条直线，其斜率的倒数 `x/y`，就是价格 `p`。当价格变化的时候，就是这条直线的斜率在变化。\\n\\n流动性就可以用一个矩形的面积来表示。因为`k`的实际意义就是用来衡量一个池子的流动性数量，而`x*y=k`，所以池子中`资产X的数量 * 资产Y的数量 = 流动性数量`。\\n\\n### 资金利用率\\n\\n价格区间(0, ∞)看起来很理想，我们的资金在任何时候（任意价格点）都能为我们赚取手续费。\\n\\n但我们忽略了另一个影响收益的重要因素，那就是资金的利用率。当一个用户来用我们的池子做交易时，其交易的量相比我们的流动性来说是很小的。\\n\\n假设现在池子内资产 X 和 Y 都有 8 个，价格 p 为 1。\\n\\n现在有一笔订单，用 1 个 X 来换取 1 个 Y，我们先不考虑滑点和手续费的影响，这一笔交易为我们带来的手续费收益是 `fee = 1 * 0.3%`，实际参与赚取手续费的流动性就是输出的 1 个 y，这相比于总流动性是很小的，在这一笔交易中，资金利用率是大约是 `1 / 8`。也就是说，我们只需要极少一部分流动性就能承载这一笔交易，而大部分流动性在交易过程中只是躺在那做收益的分母而已……\",\"timestamp\":1635859528,\"title\":\"如何理解 UniswapV3白皮书\"},\"digest\":\"UUkIux_ZiERG6a_tmdSjAgyhWyGa5heCs3RGBXwr_0U\",\"authorship\":{\"contributor\":\"0xDCFd42aCD7b56CC9Cc6B083e5E85E5022322C3C0\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"UayCTnNdpIhx2t5Bqfd6OosvF9ADQkWFC1iXr50HFfA\\\",\\\"y\\\":\\\"tHgOeptro-JYRya3vwV0ioAfj_BgEdlutDh923QtG1I\\\"}\",\"signature\":\"wkjhsflk3d1Ll2v8Co4vUNZJI9Fz-kYxBKcbdfVlh023PkuzSDz7IR8AKM8JNYikUeG6CWCe9hG6Mm927f_8-Q\",\"signingKeySignature\":\"0x243d77d92b7ab6c5b71a4b9b93fa2712a1a4c62fc089b4ec86ab4af038b5b4de2270be6e6e18537d56e367d22680d4f7a975ce69fc0ebbe6e07597b75598595c1b\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"UayCTnNdpIhx2t5Bqfd6OosvF9ADQkWFC1iXr50HFfA\\\",\\\"y\\\":\\\"tHgOeptro-JYRya3vwV0ioAfj_BgEdlutDh923QtG1I\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"xoxm5y1cN1NmbN67QVos3C2y_9IbwUL8WPBWMkQ3nbs\"}"