"{\"content\":{\"body\":\"> 这是《马修·鲍尔的元宇宙「九章算术」》的第三部分，重点介绍**网络**在「元宇宙」中发挥的作用。这里，**网络**被定义为「由骨干供应商、网络、交换中心、路由服务，以及入户运营商所共同保障的永续实时连接、高带宽、去中心化数据传输」。\\n\\n对许多读者来说，网络的三个核心命题——带宽、延迟、可靠性——似乎是元宇宙版图中最无趣的元素。但是，它们的壁垒和增长决定了元宇宙产品和服务如何设计、元宇宙何时能走到台前、我们可以或永远无法做什么。\\n\\n**带宽**\\n\\n带宽经常被认为和速度是同一个概念，但它实际上是指单位时间内可以传输的数据量。元宇宙的带宽要求比大多数互联网应用和游戏高得多，当下的连接几乎无法满足。一个用来理解的最佳案例是微软的游戏《微软模拟飞行》（Microsoft Flight Simulator）。\\n\\n《微软模拟飞行》是历史上最逼真、最广泛的消费级飞行模拟应用。它包括 2 万亿棵独立渲染的树木、15 亿座建筑和全球几乎所有的道路、山脉、城市和机场……所有这些看起来都非常逼真，因为它们是基于真实事物的高质量扫描。为了做到这一点，《微软模拟飞行》积累了超过 2.5PB（也就是 250 万 GB）的数据。消费级设备（或大多数企业设备）没有办法存储如此大量的数据。\\n\\n《微软模拟飞行》的工作方式是在你的本地设备上存储核心数据（游戏任务也由本地设备运行，与 Stadia 等基于云的游戏流服务不同）。但是当用户在线时，微软就会根据需要将大量的数据流传到本地玩家的设备上。想想看，这就像现实世界的飞行员一样。当他们翻过一座山或转过一个弯时，新的光信息就会流进他们的视网膜，首次揭示并澄清那里的情况。在此之前，他们什么都没有，只是知道那里会有什么东西。\\n\\n许多玩家认为这就是所有在线多人游戏中发生的事情。事实上，大多数游戏的服务器只向单个玩家发送关键的位置数据、玩家输入数据（如射击、投掷炸弹）和摘要级数据（如在战斗中剩余的玩家）。其余所有的资源和渲染数据都已经在本地设备上了，因此下载和安装的时间可能很漫长，也会大量消耗硬盘驱动器的空间。\\n\\n基于实时需求发送渲染数据，游戏可以容纳更多样的物品、资源和环境。这项技术可以做到不延迟游戏的下载和安装，不需要更新批处理，不浪费用户存储空间。因此，许多游戏现在正在接受这种本地存储信息加数据流的混合模式。然而这对聚焦元宇宙的平台最为重要。例如，与《马里奥赛车》或《使命召唤》这样的游戏相比，《罗布乐思》更加渴求资产、物品和环境的多样性。\\n\\n![](https://images.mirror-media.xyz/publication-images/wR4O4Gs1msB_J49tRoLBU.png?height=720&width=1280)\\n\\n随着虚拟仿真的复杂性和重要性增加，流式数据的压力也会增加。至少在目前，《罗布乐思》得益于一些基础预制构件和资产被广泛地重新利用，定制也相对轻度。鉴于此，《罗布乐思》传输的数据主要是调整先前下载的物品。但最终，这个虚拟平台会希望有近乎无限的排列组合和创造，并且运营方无法做出预测。\\n\\n像《微软模拟飞行》这样的虚拟平行世界，已经需要重现现实世界的几乎无限（和已证实的）多样性。这意味着发送的数据要比「乌云在这」或「与乌云 C-95 相似度为 95% 的乌云」具体得多。相反，它是一个需要细致描述的乌云。而且关键的是，这些数据是实时变化的。\\n\\n这最后一点是关键。如果我们想在一个大型的、实时的、共享的、持久的虚拟环境中进行互动，我们将需要接收超大量的数据流。\\n\\n![可以看出下图在光影渲染和材质上仍然有细节问题](https://images.mirror-media.xyz/publication-images/su283xcZNP9Z3VgEpxYJL.png?height=1280&width=888)\\n\\n将真实世界与《堡垒之夜》的地图相比较，地球上的每个人都在同一个「模拟环境」中，在同一时间具有唯一性。如果我砍了一棵树，那棵树就不可逆转地消失了，对每个人来说都不复存在。当你玩《堡垒之夜》时，它只是一个固定的、有时间戳标记的地图版本；你在该地图中所做的一切，只与少数用户共享，且很短一段时间内就会重置。如果砍了一棵树，它将在这局最长 25 分钟的游戏后被重置，而只有最多 99 个其他用户能意识到这棵树的变化。地图只有在 Epic Games 发出新版本的时候才会真正改变。而如果 Epic Games 想把你的世界发给其他人，他们会选择你的宇宙，不考虑他们的宇宙，并在一个特定的时间点重置你的宇宙。对于许多虚拟体验来说，甚至对于许多特定的元宇宙体验来说，这很好。但是有些体验应当被要求，在任何时候对任何用户保持恒常性。\\n\\n如果我们想在不同的虚拟世界之间无缝跳跃，云数据流也是必不可少的。《堡垒之夜》特拉维斯 · 斯科特（Travis Scott）音乐会的设计中，玩家从游戏的核心地图无缝传送到一个从未见过的海洋深处，然后到一个从未见过的星球，然后深入到外太空。为了做到这一点，Epic 在活动前几天至几个小时通过标准的游戏补丁将所有这些场景发送给用户（如果用户在活动开始前没有下载和安装更新，他们将无法加载）。游玩过程中，每个玩家的设备都在后台加载一个接一个的场景。这个系统工作得非常好，但它要求运营商提前很长时间知道（或直接设定）用户接下来会去哪个世界。如果你想选择，而且要从广泛的目的地中选择，你除了下载所有潜在选项的全部内容（这是不可能的选项），只能依赖云数据流传输。\\n\\n环境数据增量以外，还有玩家数据增量。当你今天在《堡垒之夜》中看到你的朋友时，《堡垒之夜》服务器只需要向你发送你朋友的位置和动作信息；动画（例如重新装载突击步枪或坠落）代码存储在本地，只需要被渲染。但是，当你有一个实时动作捕捉被映射到你朋友的画面时，这些详细信息也需要被发送。如果想在游戏中和其他人观看同一个视频，就像《堡垒之夜》此前的活动，那么也需要在虚拟世界内传输数据。尝试聆听空间音频，或者想感觉到路人走过在你肩旁的风声，都一样（需要传输数据）。\\n\\n即便是只需要位置和行为数据的在线游戏，许多玩家已经为难于带宽和网络拥堵；元宇宙只会加剧这些需求。好消息是，全世界的宽带普及率和带宽正在不断提高；计算能力也在不断改进，它可以通过预测「真实情况」提前处理、加载算法模拟的数据，来帮助替代受限的数据传输。\\n\\n**延迟**\\n\\n网络中最大的挑战也是它最晦涩的地方：延迟。延迟指的是数据从一个节点到另一个节点来回所需的时间。与网络带宽和可靠性相比，延迟通常被认为是最不重要的指标，这是因为大多数互联网流量是单向的或异步的。在发送 WhatsApp 信息和收到阅读回执之间间隔 100-200 ms，甚至两秒钟，这并不重要。如果你点击 YouTube 的暂停按钮，20-150 ms 后视频才停止，也没有关系。在观看 Netflix 时，连续播放流媒体比立刻开始播放更重要。为此，Netflix 人为地推迟了视频流的开始播放时间，以便你的设备能够抢在你开始观看之前下载一点。这样，即便你的网络卡顿了一会，也不会注意到。\\n\\n即使是同步连接的视频通话，对延迟的容忍度也相对较高。视频是通话中最不重要的元素，因此音频是「最轻」的数据，如果出现网络波动，音频通常会被软件优先处理。如果你的延迟暂时增加几 ms 甚至几秒钟，软件可以通过提高音频播放倍速、快速编辑音频来消除卡顿的影响。此外，用户也适应应对延迟，无非多等一下。\\n\\n然而，最具沉浸感的 3A 多人在线游戏需要低延迟。这是因为延迟决定了玩家接收信息的速度（例如，玩家在哪里，手榴弹是否被扔出或足球是否被踢出），以及他们的反应被传送给其他玩家的速度。换句话说，延迟决定了你是赢还是输。这就是为什么大多数现代游戏的帧数是视频的 2-4 倍，以及为什么我们迅速接受这些增长，即使我们不那么在乎传统视频的高帧数。这是性能的需要。\\n\\n在视频游戏中，人类对延迟的阈值低得令人难以置信。我们比较传统视频和游戏。对传统视频，一般人甚至不会注意到音频是否与视频不同步，除非声音提前了超过 45ms，或延迟了 125ms（前后有 170ms 的空间）。可接受的阈值甚至更宽，提前 90ms、延迟 185ms 以内都能接受（前后共 275ms）。对于虚拟按钮，例如 YouTube 的暂停按钮，如果我们在 200-250ms 后没有看到回应，才会认为点击失败了。在 3A 游戏中，狂热的游戏玩家能敏锐地观察到 50ms 的异步，非游戏玩家在 110ms 左右也会感到不适；游戏延迟如果达到 150ms 时就几乎不可玩。Subspace 发现，平均而言，延迟每变化 10ms，玩家每周游戏时间会相应地变化 6%。这是一个其他行业都无需面对的非同寻常的现象。\\n\\n![](https://images.mirror-media.xyz/publication-images/DBkwpkKe__DkHnrsBST1l.png?height=751&width=1280)\\n\\n有了上述感性认知，让我们看看全球的平均延迟。在美国，两个城市间数据往返时间的中位数是 35ms。许多节点组都超过了这个时间，特别是高密度和密集需求高峰的城市（例如，旧金山到纽约的晚间）。然后是数据入户的运输时间，环节中特别容易发生减速。密集的城市、社区或公寓很容易出现拥堵。如果你是通过手机玩，今天的 4G 技术平均还有 40ms 延迟。如果你住在主要城市中心以外，你的数据可能要在陈旧的、维护不善的线缆中再走 100 英里。全球范围内，城市间传输延迟中位数为 100-200ms。\\n\\n![](https://images.mirror-media.xyz/publication-images/EbS7Ng3biRgq2QkuWWJce.png?height=349&width=1280)\\n\\n为了管理延迟，在线游戏行业已经开发了许多缓解方案。然而，没有任何一种方法是特别好的。例如，大多数高保真多人游戏围绕服务器区域进行玩家匹配。通过在队列中最大限度地减少美国东北部、西欧或东南亚的玩家，游戏发行商能够在地理基础上最大限度地减少延时。由于游戏是一种休闲活动，通常是与一到三个近距离的朋友一起玩，这种集群的效果足够好。毕竟，你不太可能和几个时区以外的人一起游戏，而且你也不太关心你的未知对手（你通常甚至无法与之交谈）住在哪里。不过，Subspace 发现，在中东地区，大约有四分之三的互联网连接超出了动态多人游戏的可玩延迟水平，而在美国和欧洲，有四分之一的互联网连接超出了可玩延迟水平。在已经考虑了服务器位置的情况下，这主要反映了宽带基建的限制。\\n\\n多人在线游戏也使用「网络代码」解决方案，以确保同步性和一致性，让玩家顺畅游玩。基于延迟的网络代码将告诉玩家的设备（如 PlayStation 5）人为地延迟渲染其主人的输入，直到更多输入数据的到达。这会使那些适应低延迟的肌肉记忆的玩家感到手感变差，但它是有效的。回滚网络代码更加复杂。如果对手的输入被延迟了，玩家的设备将根据它预期发生的情况渲染。如果发现对手做了一些超预期的事情，设备将尝试喊停进行的动画，然后「正确」地回滚重放。\\n\\n这些解决方案对于 1V1 游戏（如 2D 格斗）、小延迟干扰（如 ±40ms）、行为低自由度和高度可预测的游戏（如驾驶游戏、2D 格斗）来说效果不错。但是当我们扩展到更多的聚焦元宇宙的体验，有更多的玩家、更大的延迟变化、更多的动态场景时，这些解决方案就无可奈何。我们很难连贯和正确地预测十几个玩家，并以一种非破坏性的方式「回滚」他们的渲染。相反，简单地断开一个延迟玩家的连接更有意义。虽然视频通话有许多参与者，但每次只有一个真正重要，因此有一个「核心」延迟。在游戏中，从所有玩家那里获得正确的信息是很重要的，而延迟则是复杂的。\\n\\n对于大多数游戏来说，低延迟并不是一个问题。《炉石传说》或《与朋友对话》等游戏要么是回合制，要么是异步制，而《王者荣耀》或《糖果传奇》等其他热门游戏既不需要拟真的像素，也不需要毫秒级的精确输入。真正需要低延迟的只是像《堡垒之夜》、《使命召唤》和《地平线》这样的快反应游戏。这类游戏利润丰厚，但按产品数量计算只占整个游戏市场的一隅，在总游戏时间中的份额更小。\\n\\n虽然元宇宙不等同于一个快反应的 3A 游戏，但它的社会性质和预期意义意味着它将需要低延迟。细微的面部动作对人类对话来说非常重要，而我们对细微的错误和同步问题非常敏感（CG 中的恐怖谷效应正源于此）。社交产品也依赖于它们的普适性。类比一下可以想象，除非你的朋友或家人在 500 英里以内或你在家，否则 FaceTime 或 Facebook 无法使用的场景。如果我们想在虚拟世界中实现诸多远程行动，我们需要的不仅仅是多余的带宽。\\n\\n![](https://images.mirror-media.xyz/publication-images/6S0xB5OfdRnzQIOKW6Mu4.png?height=323&width=1280)\\n\\n不幸的是，延迟是所有网络属性中最难解决的，也是最慢的。如上所述，这个问题的部分原因是很少有服务和应用需要超低延迟交付。这限制了任何网络运营商或以延迟为重点的解析服务做商业尝试，因为商业模式很难成立，并且最终无法绕过基本物理定律。\\n\\n对于 11000-12500 公里，相当于纽约市到东京或孟买的距离，骨干网传输需要 40-45ms，符合低延迟的标准。然而，虽然大多数互联网主干是光纤，但光纤电缆比光速差了 30%，因为它毕竟不是纯粹真空（损耗通常为 3.5 dB/km）。铜缆和同轴电缆远距离上有更糟糕的延迟衰减，而且带宽更有限，这意味着拥堵和高 ping 的风险更大。这些电缆在住宅和商业建筑内部以及社区中仍占较大比例。\\n\\n此外，这些电缆的铺设都不是一帆风顺的。而我们通常认为的互联网主干网实际上是一个松散的私人网络联盟，其中没有一个负责完整地传递数据包（或被设计成主动寻找和托付拥有一两个更快网段的主机）。因此，一对节点的网络距离可能比它们的地理距离大得多。此外，为了确保可靠和持续的交付，网络拥堵时流量路由可能更间接，而不是以减少延迟为首��目标。这就是为什么从纽约到东京的平均网络延迟是光速理论时间的 4 倍以上，而从纽约市到孟买的延迟是 4-6 倍。\\n\\n升级或中继任何基于电缆的基建是非常昂贵和困难的，特别是如果以减少物理距离为目标。这需要面对监管或政府层层设卡的审批。当然要解决无线问题更容易。而 5G 当然有帮助，因为它的延迟平均比 4G 少 20-40ms（并承诺低至 1ms 的延迟）。然而，这只有助于数据传输抵达终端的入户阶段。一旦你的数据到达塔台，你就回到了传统的骨干网。\\n\\nSpaceX 的卫星互联网公司星链（Starlink）承诺为整个美国提供高带宽、低延迟的互联网服务，并最终覆盖世界其他地区。但这并不能解决超低延迟的问题，特别是针对距离。虽然星链实现了你家和卫星之间通讯的 18-35ms 延迟，但当数据在纽约和洛杉矶之间往返时，延迟还会更长，毕竟这需要在多颗卫星上进行中继。在某些情况下，星链甚至增加了旅行距离。纽约到费城的直线距离约为 100 英里，光缆距离可能为 125 英里，但在地面和空间轨道间来回超过 700 英里。此外，光缆的损耗比大气层传输要小得多，特别是在阴天。人口稠密的城市地区也很嘈杂，因此会出现干扰。2020 年埃隆·马斯克强调，星链专注于「传统电信公司几乎无法满足的、要求最苛刻的客户」。在这个意义上，它将更多的人带入元宇宙，而不是为那些已经置身其中的人提速。\\n\\n全新的技术、业务线和服务正在被开发，以满足对实时带宽应用日益增长的需求。例如，Subspace 在数百个城市部署硬件，以开发用于低延迟网络寻路的「天气图」；运营一个网络堆栈，然后将低延迟应用的需求与体系中许多第三方进行协调；甚至还建立了一个光纤网络，在各种光纤网络之间进行拼接，以进一步缩短服务器之间的距离，并尽量减少非光纤电缆的使用。\\n\\n同时，Fastly 提供了一个不仅为可靠性和带宽，还为低延迟应用做优化的解析网络服务。该公司采用 「基础架构即代码」（Infrastructure as code）的方法，允许客户定制该公司边缘计算集群的几乎每一个维度，承诺任意软件应用程序可以在 150ms 内清除和替换全球所有这些集群的所有缓存内容，并且可以实时缓存和加速单个区块链交易。\\n\\n**可靠性**\\n\\n顾名思义，我们转移到虚拟劳动和教育的能力直接取决于服务质量的可靠性。这既包括整体正常运行的过程，也包括其他内在特征的一致性，如下载/上传带宽和延迟。对于当今的许多网络原住民来说，上述大部分内容可能看起来是危言耸听。Netflix 的流媒体在大多数时候都是 1080p 甚至4K，完全没有问题。然而，像 Netflix 这样的服务利用可靠性解决方案，对于游戏或元宇宙的特定应用来说，效果并不好。\\n\\n像 Netflix 这样的非实时视频服务，在向观众提供视频文件之前的数小时到数月就收到所有视频文件。这使他们能够进行广泛的分析，以便通过分析帧数据来压缩文件大小，以确定哪些信息可以被忽略。Netflix 的算法将识别一个有蓝天的场景，并决定，如果观众的网速下降，500 种不同的蓝色可以简化为 200 种、50 种、甚至 25 种。流媒体公司的数据分析甚至通过前后对比做到这一点——他们认识到对话场景比那些快节奏动作可以容忍更大的压缩比。这就是多通道编码。正如前面所讨论的，Netflix 还利用闲置带宽在用户需要之前将数据提前下载到设备上。因此，如果网络出现负向波动，终端用户不会感知任何变化。此外，Netflix 会在本地节点上预装内容；因此，当你要求看最新一集的《陌生人》时，它实际上只需要多读取几个区块。这对于实时创建的视频或数据来说是不可能的，根据上文所述，它们也需要更快地到达。这就是为什么 1GB 的 Stadia 云数据流比 1GB 的 Netflix 更难。\\n\\n因此，即使 3A 多人游戏这种应用在将来未必具备竞争力，我们也应该认为元宇宙对网络的所有方面——延迟、可靠性/弹性和带宽——的要求至少是与之相同的水平。如果你的设备不能及时接收它所需要的所有信息，那么你的设备即使再强大都毫无意义。\",\"timestamp\":1640594890,\"title\":\"马修・鲍尔的元宇宙「九章算术」| 第三章 网络：连接元宇宙\"},\"digest\":\"z0jHVOUjEl60gRJthoxusP6DR3p8wUvo181gCgysVoo\",\"authorship\":{\"contributor\":\"0xff87a8C90595171D06c92D6926dBBf43777CF7A3\",\"signingKey\":\"{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"5g_Dbf6NRjOOdsN_gNTYDUp7jxdqo8bEfMIzoYth288\\\",\\\"y\\\":\\\"C1OYNqeosr_4HtVkYJQoC0aJ2q70wMuj3WPJtWPOgFs\\\"}\",\"signature\":\"2fnT4JmFMrlsN8jQXppCpcG3y0Z0PUrNwb1rNUyMYaTMEEOAhi1zQXW5z0G7eFxFDbwCqmgkSlPlYkmVzISPbg\",\"signingKeySignature\":\"0x464997dffdb17966023bfca7981c6599757934c5d5db47aa47b30c40b09b1ad340021f21d538e0cb68b52d02728c34617ba6f18a8adcef4f693f3e23d20418851b\",\"signingKeyMessage\":\"I authorize publishing on mirror.xyz from this device using:\\n{\\\"crv\\\":\\\"P-256\\\",\\\"ext\\\":true,\\\"key_ops\\\":[\\\"verify\\\"],\\\"kty\\\":\\\"EC\\\",\\\"x\\\":\\\"5g_Dbf6NRjOOdsN_gNTYDUp7jxdqo8bEfMIzoYth288\\\",\\\"y\\\":\\\"C1OYNqeosr_4HtVkYJQoC0aJ2q70wMuj3WPJtWPOgFs\\\"}\",\"algorithm\":{\"name\":\"ECDSA\",\"hash\":\"SHA-256\"}},\"nft\":{},\"version\":\"12-21-2020\",\"originalDigest\":\"z0jHVOUjEl60gRJthoxusP6DR3p8wUvo181gCgysVoo\"}"